{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/microcarbonoffsettracker/hooks/useContract.ts"],"sourcesContent":["\"use client\"\n\n/**\n * ============================================================================\n * IOTA CONTRACT INTEGRATION HOOK - MICRO CARBON OFFSET TRACKER\n * ============================================================================\n * \n * This hook contains ALL the contract interaction logic for Carbon Offset Tracker.\n * \n * ============================================================================\n */\n\nimport { useState, useEffect } from \"react\"\nimport {\n  useCurrentAccount,\n  useIotaClient,\n  useSignAndExecuteTransaction,\n  useIotaClientQuery,\n} from \"@iota/dapp-kit\"\nimport { useNetworkVariable } from \"@/lib/config\"\nimport type { IotaObjectData } from \"@iota/iota-sdk/client\"\n\n// ============================================================================\n// CONTRACT CONFIGURATION\n// ============================================================================\n\nexport const CONTRACT_MODULE = \"contract\" // Your Move module name\nexport const CONTRACT_METHODS = {\n  CREATE: \"create\",\n  ADD_OFFSET: \"add_offset\",\n  TRANSFER_OFFSET: \"transfer_offset\",\n  INCREMENT: \"increment\",\n  SET_VALUE: \"set_value\",\n  GET_TOTAL: \"get_total\",\n  GET_OWNER: \"get_owner\",\n} as const\n\n// ============================================================================\n// DATA EXTRACTION\n// ============================================================================\n\nfunction getObjectFields(data: IotaObjectData): { value: number; owner: string } | null {\n  if (data.content?.dataType !== \"moveObject\") {\n    console.log(\"Data is not a moveObject:\", data.content?.dataType)\n    return null\n  }\n  \n  const fields = data.content.fields as any\n  if (!fields) {\n    console.log(\"No fields found in object data\")\n    return null\n  }\n  \n  // Log the actual structure for debugging\n  console.log(\"Object fields structure:\", JSON.stringify(fields, null, 2))\n  \n  // Extract total_offset_kg (value) and owner\n  let value: number\n  \n  // Try different possible field names\n  if (fields.total_offset_kg !== undefined) {\n    value = typeof fields.total_offset_kg === \"string\" \n      ? parseInt(fields.total_offset_kg, 10) \n      : fields.total_offset_kg\n  } else if (fields.value !== undefined) {\n    value = typeof fields.value === \"string\" \n      ? parseInt(fields.value, 10) \n      : fields.value\n  } else {\n    console.log(\"Value field not found in object\")\n    return null\n  }\n  \n  if (isNaN(value)) {\n    console.log(\"Value is not a valid number\")\n    return null\n  }\n  \n  // Extract owner\n  if (!fields.owner) {\n    console.log(\"Owner field is missing\")\n    return null\n  }\n  \n  const owner = String(fields.owner)\n  \n  return {\n    value,\n    owner,\n  }\n}\n\n// ============================================================================\n// INTERFACE DEFINITIONS\n// ============================================================================\n\nexport interface ContractData {\n  value: number\n  owner: string\n}\n\nexport interface ContractState {\n  isLoading: boolean\n  isPending: boolean\n  isConfirming: boolean\n  isConfirmed: boolean\n  hash: string | undefined\n  error: Error | null\n}\n\nexport interface ContractActions {\n  createObject: () => Promise<void>\n  addOffset: (amount: number) => Promise<void>\n  transferOffset: (to: string, amount: number) => Promise<void>\n  increment: () => Promise<void>\n  setValue: (value: number) => Promise<void>\n  getTotalOffset: () => Promise<number | null>\n  getOwner: () => Promise<string | null>\n  clearObject: () => void\n}\n\n// ============================================================================\n// MAIN HOOK\n// ============================================================================\n\nexport const useContract = () => {\n  const currentAccount = useCurrentAccount()\n  const address = currentAccount?.address\n  const packageId = useNetworkVariable(\"packageId\")\n  const iotaClient = useIotaClient()\n  const { mutate: signAndExecute, isPending } = useSignAndExecuteTransaction()\n  const [objectId, setObjectId] = useState<string | null>(null)\n  const [isLoading, setIsLoading] = useState(false)\n  const [hash, setHash] = useState<string | undefined>()\n  const [transactionError, setTransactionError] = useState<Error | null>(null)\n\n  // Load object ID from URL hash\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      const hash = window.location.hash.slice(1)\n      if (hash) setObjectId(hash)\n    }\n  }, [])\n\n  // Fetch object data\n  const { data, isPending: isFetching, error: queryError, refetch } = useIotaClientQuery(\n    \"getObject\",\n    {\n      id: objectId!,\n      options: { showContent: true, showOwner: true },\n    },\n    {\n      enabled: !!objectId,\n    }\n  )\n\n  // Extract fields\n  const fields = data?.data ? getObjectFields(data.data) : null\n  const isOwner = fields?.owner.toLowerCase() === address?.toLowerCase()\n  const objectExists = !!data?.data\n  const hasValidData = !!fields\n\n  // ============================================================================\n  // HELPER FUNCTIONS FOR TRANSACTION CREATION\n  // ============================================================================\n\n  // Helper to create moveCall transaction\n  const createMoveCallTx = (target: string, args: any[]) => {\n    // Dynamically import Transaction to avoid import issues\n    const Transaction = require(\"@iota/iota-sdk/transactions\").Transaction;\n    const tx = new Transaction();\n    tx.moveCall({\n      target,\n      arguments: args,\n    });\n    return tx;\n  };\n\n  // Helper to create object argument\n  const txObject = (objectId: string) => {\n    const Transaction = require(\"@iota/iota-sdk/transactions\").Transaction;\n    const tx = new Transaction();\n    return tx.object(objectId);\n  };\n\n  // Helper to create pure arguments\n  const txPure = {\n    u64: (value: number) => {\n      const Transaction = require(\"@iota/iota-sdk/transactions\").Transaction;\n      const tx = new Transaction();\n      return tx.pure.u64(value);\n    },\n    address: (value: string) => {\n      const Transaction = require(\"@iota/iota-sdk/transactions\").Transaction;\n      const tx = new Transaction();\n      return tx.pure.address(value);\n    }\n  };\n\n  // ============================================================================\n  // CONTRACT FUNCTIONS\n  // ============================================================================\n\n  // Create object\n  const createObject = async () => {\n    if (!packageId) return\n\n    try {\n      setIsLoading(true)\n      setTransactionError(null)\n      setHash(undefined)\n      \n      const tx = createMoveCallTx(\n        `${packageId}::${CONTRACT_MODULE}::${CONTRACT_METHODS.CREATE}`,\n        []\n      );\n\n      signAndExecute(\n        { transaction: tx },\n        {\n          onSuccess: async ({ digest }) => {\n            setHash(digest)\n            try {\n              const { effects } = await iotaClient.waitForTransaction({\n                digest,\n                options: { showEffects: true },\n              })\n              const newObjectId = effects?.created?.[0]?.reference?.objectId\n              if (newObjectId) {\n                setObjectId(newObjectId)\n                if (typeof window !== \"undefined\") {\n                  window.location.hash = newObjectId\n                }\n                setIsLoading(false)\n              } else {\n                setIsLoading(false)\n                console.warn(\"No object ID found in transaction effects\")\n              }\n            } catch (waitError) {\n              console.error(\"Error waiting for transaction:\", waitError)\n              setIsLoading(false)\n            }\n          },\n          onError: (err) => {\n            const error = err instanceof Error ? err : new Error(String(err))\n            setTransactionError(error)\n            console.error(\"Error:\", err)\n            setIsLoading(false)\n          },\n        }\n      )\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err))\n      setTransactionError(error)\n      console.error(\"Error creating object:\", err)\n      setIsLoading(false)\n    }\n  }\n\n  // Add carbon offset\n  const addOffset = async (amount: number) => {\n    if (!objectId || !packageId) return\n\n    try {\n      setIsLoading(true)\n      setTransactionError(null)\n      const tx = createMoveCallTx(\n        `${packageId}::${CONTRACT_MODULE}::${CONTRACT_METHODS.ADD_OFFSET}`,\n        [txObject(objectId), txPure.u64(amount)]\n      );\n\n      signAndExecute(\n        { transaction: tx },\n        {\n          onSuccess: async ({ digest }) => {\n            setHash(digest)\n            await iotaClient.waitForTransaction({ digest })\n            await refetch()\n            setIsLoading(false)\n          },\n          onError: (err) => {\n            const error = err instanceof Error ? err : new Error(String(err))\n            setTransactionError(error)\n            console.error(\"Error adding offset:\", err)\n            setIsLoading(false)\n          },\n        }\n      )\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err))\n      setTransactionError(error)\n      console.error(\"Error adding offset:\", err)\n      setIsLoading(false)\n    }\n  }\n\n  // Transfer offset to another user\n  const transferOffset = async (to: string, amount: number) => {\n    if (!objectId || !packageId) return\n\n    try {\n      setIsLoading(true)\n      setTransactionError(null)\n      const tx = createMoveCallTx(\n        `${packageId}::${CONTRACT_MODULE}::${CONTRACT_METHODS.TRANSFER_OFFSET}`,\n        [txObject(objectId), txPure.address(to), txPure.u64(amount)]\n      );\n\n      signAndExecute(\n        { transaction: tx },\n        {\n          onSuccess: async ({ digest }) => {\n            setHash(digest)\n            await iotaClient.waitForTransaction({ digest })\n            await refetch()\n            setIsLoading(false)\n          },\n          onError: (err) => {\n            const error = err instanceof Error ? err : new Error(String(err))\n            setTransactionError(error)\n            console.error(\"Error transferring offset:\", err)\n            setIsLoading(false)\n          },\n        }\n      )\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err))\n      setTransactionError(error)\n      console.error(\"Error transferring offset:\", err)\n      setIsLoading(false)\n    }\n  }\n\n  // Increment (for testing)\n  const increment = async () => {\n    if (!objectId || !packageId) return\n\n    try {\n      setIsLoading(true)\n      setTransactionError(null)\n      const tx = createMoveCallTx(\n        `${packageId}::${CONTRACT_MODULE}::${CONTRACT_METHODS.INCREMENT}`,\n        [txObject(objectId)]\n      );\n\n      signAndExecute(\n        { transaction: tx },\n        {\n          onSuccess: async ({ digest }) => {\n            setHash(digest)\n            await iotaClient.waitForTransaction({ digest })\n            await refetch()\n            setIsLoading(false)\n          },\n          onError: (err) => {\n            const error = err instanceof Error ? err : new Error(String(err))\n            setTransactionError(error)\n            console.error(\"Error incrementing:\", err)\n            setIsLoading(false)\n          },\n        }\n      )\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err))\n      setTransactionError(error)\n      console.error(\"Error incrementing:\", err)\n      setIsLoading(false)\n    }\n  }\n\n  // Set value (admin only)\n  const setValue = async (value: number) => {\n    if (!objectId || !packageId) return\n\n    try {\n      setIsLoading(true)\n      setTransactionError(null)\n      const tx = createMoveCallTx(\n        `${packageId}::${CONTRACT_MODULE}::${CONTRACT_METHODS.SET_VALUE}`,\n        [txObject(objectId), txPure.u64(value)]\n      );\n\n      signAndExecute(\n        { transaction: tx },\n        {\n          onSuccess: async ({ digest }) => {\n            setHash(digest)\n            await iotaClient.waitForTransaction({ digest })\n            await refetch()\n            setIsLoading(false)\n          },\n          onError: (err) => {\n            const error = err instanceof Error ? err : new Error(String(err))\n            setTransactionError(error)\n            console.error(\"Error setting value:\", err)\n            setIsLoading(false)\n          },\n        }\n      )\n    } catch (err) {\n      const error = err instanceof Error ? err : new Error(String(err))\n      setTransactionError(error)\n      console.error(\"Error setting value:\", err)\n      setIsLoading(false)\n    }\n  }\n\n  // Get total offset (view function)\n  const getTotalOffset = async (): Promise<number | null> => {\n    if (!objectId || !packageId) return null\n\n    try {\n      // For view functions, we can use the existing data\n      return fields?.value || null\n    } catch (err) {\n      console.error(\"Error getting total offset:\", err)\n      return null\n    }\n  }\n\n  // Get owner (view function)\n  const getOwner = async (): Promise<string | null> => {\n    if (!objectId || !packageId) return null\n\n    try {\n      return fields?.owner || null\n    } catch (err) {\n      console.error(\"Error getting owner:\", err)\n      return null\n    }\n  }\n\n  // Clear object\n  const clearObject = () => {\n    setObjectId(null)\n    setTransactionError(null)\n    if (typeof window !== \"undefined\") {\n      window.location.hash = \"\"\n    }\n  }\n\n  // ============================================================================\n  // RETURN VALUES\n  // ============================================================================\n\n  const contractData: ContractData | null = fields\n    ? {\n        value: fields.value,\n        owner: fields.owner,\n      }\n    : null\n\n  const actions: ContractActions = {\n    createObject,\n    addOffset,\n    transferOffset,\n    increment,\n    setValue,\n    getTotalOffset,\n    getOwner,\n    clearObject,\n  }\n\n  const contractState: ContractState = {\n    isLoading: (isLoading && !objectId) || isPending || isFetching,\n    isPending,\n    isConfirming: false,\n    isConfirmed: !!hash && !isLoading && !isPending,\n    hash,\n    error: queryError || transactionError,\n  }\n\n  // Simple wallet connect/disconnect (dApp Kit handles this automatically)\n  const connect = () => {\n    console.log(\"Wallet connection is handled by dApp Kit - check if wallet extension is installed\")\n  }\n\n  const disconnect = () => {\n    console.log(\"Wallet disconnection is handled by dApp Kit\")\n  }\n\n  return {\n    // Account info\n    account: currentAccount,\n    address,\n    packageId,\n    \n    // Contract data\n    data: contractData,\n    contractData, // alias for compatibility\n    \n    // Actions\n    actions,\n    ...actions, // Spread actions for direct access\n    \n    // State\n    state: contractState,\n    loading: contractState.isLoading,\n    error: contractState.error,\n    transactionResult: hash ? { digest: hash } : null,\n    \n    // Object info\n    objectId,\n    isOwner,\n    objectExists,\n    hasValidData,\n    \n    // Wallet functions\n    connect,\n    disconnect,\n    \n    // Helper functions\n    getTotalOffset: actions.getTotalOffset,\n    getOwner: actions.getOwner,\n  }\n}\n\n// Type export for convenience\nexport type UseContractReturn = ReturnType<typeof useContract>"],"names":[],"mappings":"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"}},
    {"offset": {"line": 429, "column": 0}, "map": {"version":3,"sources":["file:///D:/microcarbonoffsettracker/components/sample.tsx"],"sourcesContent":["\"use client\"\n\n/**\n * ============================================================================\n * IOTA DAPP INTEGRATION COMPONENT\n * ============================================================================\n * \n * This is the main integration component for your IOTA dApp.\n * \n * All the contract logic is in hooks/useContract.ts\n * \n * To customize your dApp, modify this file.\n * \n * ============================================================================\n */\n\nimport { useCurrentAccount } from \"@iota/dapp-kit\"\nimport { useContract } from \"@/hooks/useContract\"\nimport { Button, Container, Flex, Heading, Text } from \"@radix-ui/themes\"\nimport ClipLoader from \"react-spinners/ClipLoader\"\n\nconst SampleIntegration = () => {\n  const currentAccount = useCurrentAccount()\n  const { data, actions, state, objectId, isOwner, objectExists, hasValidData } = useContract()\n  \n  const isConnected = !!currentAccount\n\n  if (!isConnected) {\n    return (\n      <div style={{ minHeight: \"100vh\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", padding: \"1rem\" }}>\n        <div style={{ maxWidth: \"500px\", width: \"100%\" }}>\n          <Heading size=\"6\" style={{ marginBottom: \"1rem\" }}>IOTA dApp</Heading>\n          <Text>Please connect your wallet to interact with the contract.</Text>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div style={{ minHeight: \"100vh\", padding: \"1rem\", background: \"var(--gray-a2)\" }}>\n      <Container style={{ maxWidth: \"800px\", margin: \"0 auto\" }}>\n        <Heading size=\"6\" style={{ marginBottom: \"2rem\" }}>IOTA Counter dApp</Heading>\n\n        {!objectId ? (\n          <div>\n            <Button\n              size=\"3\"\n              onClick={actions.createObject}\n              disabled={state.isPending}\n            >\n              {state.isPending ? (\n                <>\n                  <ClipLoader size={16} style={{ marginRight: \"8px\" }} />\n                  Creating...\n                </>\n              ) : (\n                \"Create Counter\"\n              )}\n            </Button>\n            {state.error && (\n              <div style={{ marginTop: \"1rem\", padding: \"1rem\", background: \"var(--red-a3)\", borderRadius: \"8px\" }}>\n                <Text style={{ color: \"var(--red-11)\" }}>\n                  Error: {(state.error as Error)?.message || String(state.error)}\n                </Text>\n              </div>\n            )}\n          </div>\n        ) : (\n          <div>\n            {state.isLoading && !data ? (\n              <Text>Loading object...</Text>\n            ) : state.error ? (\n              <div style={{ padding: \"1rem\", background: \"var(--red-a3)\", borderRadius: \"8px\" }}>\n                <Text style={{ color: \"var(--red-11)\", display: \"block\", marginBottom: \"0.5rem\" }}>\n                  Error loading object\n                </Text>\n                <Text size=\"2\" style={{ color: \"var(--red-11)\" }}>\n                  {state.error.message || \"Object not found or invalid\"}\n                </Text>\n                <Text size=\"1\" style={{ color: \"var(--gray-a11)\", marginTop: \"0.5rem\", display: \"block\" }}>\n                  Object ID: {objectId}\n                </Text>\n                <Button\n                  size=\"2\"\n                  variant=\"soft\"\n                  onClick={actions.clearObject}\n                  style={{ marginTop: \"1rem\" }}\n                >\n                  Clear & Create New\n                </Button>\n              </div>\n            ) : objectExists && !hasValidData ? (\n              <div style={{ padding: \"1rem\", background: \"var(--yellow-a3)\", borderRadius: \"8px\" }}>\n                <Text style={{ color: \"var(--yellow-11)\" }}>\n                  Object found but data structure is invalid. Please check the contract structure.\n                </Text>\n                <Text size=\"1\" style={{ color: \"var(--gray-a11)\", marginTop: \"0.5rem\", display: \"block\" }}>\n                  Object ID: {objectId}\n                </Text>\n              </div>\n            ) : data ? (\n              <div>\n                <div style={{ marginBottom: \"1rem\", padding: \"1rem\", background: \"var(--gray-a3)\", borderRadius: \"8px\" }}>\n                  <Text size=\"2\" style={{ display: \"block\", marginBottom: \"0.5rem\" }}>Counter Value</Text>\n                  <Heading size=\"8\">{data.value}</Heading>\n                  <Text size=\"1\" style={{ color: \"var(--gray-a11)\", marginTop: \"0.5rem\", display: \"block\" }}>\n                    Object ID: {objectId}\n                  </Text>\n                </div>\n\n                <Flex gap=\"2\" style={{ marginBottom: \"1rem\" }}>\n                  <Button\n                    onClick={actions.increment}\n                    disabled={state.isLoading || state.isPending}\n                  >\n                    {state.isLoading || state.isPending ? (\n                      <ClipLoader size={16} />\n                    ) : (\n                      \"Increment\"\n                    )}\n                  </Button>\n                  {isOwner && (\n                    <Button\n                      onClick={actions.reset}\n                      disabled={state.isLoading || state.isPending}\n                    >\n                      {state.isLoading || state.isPending ? (\n                        <ClipLoader size={16} />\n                      ) : (\n                        \"Reset\"\n                      )}\n                    </Button>\n                  )}\n                </Flex>\n\n                {state.hash && (\n                  <div style={{ marginTop: \"1rem\", padding: \"1rem\", background: \"var(--gray-a3)\", borderRadius: \"8px\" }}>\n                    <Text size=\"1\" style={{ display: \"block\", marginBottom: \"0.5rem\" }}>Transaction Hash</Text>\n                    <Text size=\"2\" style={{ fontFamily: \"monospace\", wordBreak: \"break-all\" }}>{state.hash}</Text>\n                    {state.isConfirmed && (\n                      <Text size=\"2\" style={{ color: \"green\", marginTop: \"0.5rem\", display: \"block\" }}>\n                        Transaction confirmed!\n                      </Text>\n                    )}\n                  </div>\n                )}\n\n                {state.error && (\n                  <div style={{ marginTop: \"1rem\", padding: \"1rem\", background: \"var(--red-a3)\", borderRadius: \"8px\" }}>\n                    <Text style={{ color: \"var(--red-11)\" }}>\n                      Error: {(state.error as Error)?.message || String(state.error)}\n                    </Text>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div style={{ padding: \"1rem\", background: \"var(--yellow-a3)\", borderRadius: \"8px\" }}>\n                <Text style={{ color: \"var(--yellow-11)\" }}>Object not found</Text>\n                <Text size=\"1\" style={{ color: \"var(--gray-a11)\", marginTop: \"0.5rem\", display: \"block\" }}>\n                  Object ID: {objectId}\n                </Text>\n                <Button\n                  size=\"2\"\n                  variant=\"soft\"\n                  onClick={actions.clearObject}\n                  style={{ marginTop: \"1rem\" }}\n                >\n                  Clear & Create New\n                </Button>\n              </div>\n            )}\n          </div>\n        )}\n      </Container>\n    </div>\n  )\n}\n\nexport default SampleIntegration\n"],"names":[],"mappings":";;;;;AAEA;;;;;;;;;;;;CAYC,GAED;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAnBA;;;;;;AAqBA,MAAM,oBAAoB;IACxB,MAAM,iBAAiB,IAAA,kLAAiB;IACxC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,IAAA,mIAAW;IAE3F,MAAM,cAAc,CAAC,CAAC;IAEtB,IAAI,CAAC,aAAa;QAChB,qBACE,8OAAC;YAAI,OAAO;gBAAE,WAAW;gBAAS,SAAS;gBAAQ,YAAY;gBAAU,gBAAgB;gBAAU,SAAS;YAAO;sBACjH,cAAA,8OAAC;gBAAI,OAAO;oBAAE,UAAU;oBAAS,OAAO;gBAAO;;kCAC7C,8OAAC,0LAAO;wBAAC,MAAK;wBAAI,OAAO;4BAAE,cAAc;wBAAO;kCAAG;;;;;;kCACnD,8OAAC,oLAAI;kCAAC;;;;;;;;;;;;;;;;;IAId;IAEA,qBACE,8OAAC;QAAI,OAAO;YAAE,WAAW;YAAS,SAAS;YAAQ,YAAY;QAAiB;kBAC9E,cAAA,8OAAC,8LAAS;YAAC,OAAO;gBAAE,UAAU;gBAAS,QAAQ;YAAS;;8BACtD,8OAAC,0LAAO;oBAAC,MAAK;oBAAI,OAAO;wBAAE,cAAc;oBAAO;8BAAG;;;;;;gBAElD,CAAC,yBACA,8OAAC;;sCACC,8OAAC,wLAAM;4BACL,MAAK;4BACL,SAAS,QAAQ,YAAY;4BAC7B,UAAU,MAAM,SAAS;sCAExB,MAAM,SAAS,iBACd;;kDACE,8OAAC,0JAAU;wCAAC,MAAM;wCAAI,OAAO;4CAAE,aAAa;wCAAM;;;;;;oCAAK;;+CAIzD;;;;;;wBAGH,MAAM,KAAK,kBACV,8OAAC;4BAAI,OAAO;gCAAE,WAAW;gCAAQ,SAAS;gCAAQ,YAAY;gCAAiB,cAAc;4BAAM;sCACjG,cAAA,8OAAC,oLAAI;gCAAC,OAAO;oCAAE,OAAO;gCAAgB;;oCAAG;oCAC9B,MAAM,KAAK,EAAY,WAAW,OAAO,MAAM,KAAK;;;;;;;;;;;;;;;;;6EAMrE,8OAAC;8BACE,MAAM,SAAS,IAAI,CAAC,qBACnB,8OAAC,oLAAI;kCAAC;;;;;mEACJ,MAAM,KAAK,iBACb,8OAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAiB,cAAc;wBAAM;;0CAC9E,8OAAC,oLAAI;gCAAC,OAAO;oCAAE,OAAO;oCAAiB,SAAS;oCAAS,cAAc;gCAAS;0CAAG;;;;;;0CAGnF,8OAAC,oLAAI;gCAAC,MAAK;gCAAI,OAAO;oCAAE,OAAO;gCAAgB;0CAC5C,MAAM,KAAK,CAAC,OAAO,IAAI;;;;;;0CAE1B,8OAAC,oLAAI;gCAAC,MAAK;gCAAI,OAAO;oCAAE,OAAO;oCAAmB,WAAW;oCAAU,SAAS;gCAAQ;;oCAAG;oCAC7E;;;;;;;0CAEd,8OAAC,wLAAM;gCACL,MAAK;gCACL,SAAQ;gCACR,SAAS,QAAQ,WAAW;gCAC5B,OAAO;oCAAE,WAAW;gCAAO;0CAC5B;;;;;;;;;;;mEAID,gBAAgB,CAAC,6BACnB,8OAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAoB,cAAc;wBAAM;;0CACjF,8OAAC,oLAAI;gCAAC,OAAO;oCAAE,OAAO;gCAAmB;0CAAG;;;;;;0CAG5C,8OAAC,oLAAI;gCAAC,MAAK;gCAAI,OAAO;oCAAE,OAAO;oCAAmB,WAAW;oCAAU,SAAS;gCAAQ;;oCAAG;oCAC7E;;;;;;;;;;;;mEAGd,qBACF,8OAAC;;0CACC,8OAAC;gCAAI,OAAO;oCAAE,cAAc;oCAAQ,SAAS;oCAAQ,YAAY;oCAAkB,cAAc;gCAAM;;kDACrG,8OAAC,oLAAI;wCAAC,MAAK;wCAAI,OAAO;4CAAE,SAAS;4CAAS,cAAc;wCAAS;kDAAG;;;;;;kDACpE,8OAAC,0LAAO;wCAAC,MAAK;kDAAK,KAAK,KAAK;;;;;;kDAC7B,8OAAC,oLAAI;wCAAC,MAAK;wCAAI,OAAO;4CAAE,OAAO;4CAAmB,WAAW;4CAAU,SAAS;wCAAQ;;4CAAG;4CAC7E;;;;;;;;;;;;;0CAIhB,8OAAC,oLAAI;gCAAC,KAAI;gCAAI,OAAO;oCAAE,cAAc;gCAAO;;kDAC1C,8OAAC,wLAAM;wCACL,SAAS,QAAQ,SAAS;wCAC1B,UAAU,MAAM,SAAS,IAAI,MAAM,SAAS;kDAE3C,MAAM,SAAS,IAAI,MAAM,SAAS,iBACjC,8OAAC,0JAAU;4CAAC,MAAM;;;;;uFAElB;;;;;;oCAGH,yBACC,8OAAC,wLAAM;wCACL,SAAS,QAAQ,KAAK;wCACtB,UAAU,MAAM,SAAS,IAAI,MAAM,SAAS;kDAE3C,MAAM,SAAS,IAAI,MAAM,SAAS,iBACjC,8OAAC,0JAAU;4CAAC,MAAM;;;;;uFAElB;;;;;;;;;;;;4BAMP,MAAM,IAAI,kBACT,8OAAC;gCAAI,OAAO;oCAAE,WAAW;oCAAQ,SAAS;oCAAQ,YAAY;oCAAkB,cAAc;gCAAM;;kDAClG,8OAAC,oLAAI;wCAAC,MAAK;wCAAI,OAAO;4CAAE,SAAS;4CAAS,cAAc;wCAAS;kDAAG;;;;;;kDACpE,8OAAC,oLAAI;wCAAC,MAAK;wCAAI,OAAO;4CAAE,YAAY;4CAAa,WAAW;wCAAY;kDAAI,MAAM,IAAI;;;;;;oCACrF,MAAM,WAAW,kBAChB,8OAAC,oLAAI;wCAAC,MAAK;wCAAI,OAAO;4CAAE,OAAO;4CAAS,WAAW;4CAAU,SAAS;wCAAQ;kDAAG;;;;;;;;;;;;4BAOtF,MAAM,KAAK,kBACV,8OAAC;gCAAI,OAAO;oCAAE,WAAW;oCAAQ,SAAS;oCAAQ,YAAY;oCAAiB,cAAc;gCAAM;0CACjG,cAAA,8OAAC,oLAAI;oCAAC,OAAO;wCAAE,OAAO;oCAAgB;;wCAAG;wCAC9B,MAAM,KAAK,EAAY,WAAW,OAAO,MAAM,KAAK;;;;;;;;;;;;;;;;;iFAMrE,8OAAC;wBAAI,OAAO;4BAAE,SAAS;4BAAQ,YAAY;4BAAoB,cAAc;wBAAM;;0CACjF,8OAAC,oLAAI;gCAAC,OAAO;oCAAE,OAAO;gCAAmB;0CAAG;;;;;;0CAC5C,8OAAC,oLAAI;gCAAC,MAAK;gCAAI,OAAO;oCAAE,OAAO;oCAAmB,WAAW;oCAAU,SAAS;gCAAQ;;oCAAG;oCAC7E;;;;;;;0CAEd,8OAAC,wLAAM;gCACL,MAAK;gCACL,SAAQ;gCACR,SAAS,QAAQ,WAAW;gCAC5B,OAAO;oCAAE,WAAW;gCAAO;0CAC5B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjB;uCAEe"}}]
}